<!--
Citation for CS 340 Project - Group 28
Date: 11/06/2025 (Web Application), 12/06/2025 (CUD)
Adapted from and based on CS 340 - Explorations - Web Application Technology and Implementing CUD operations in your app
Source URL (Web Application): https://canvas.oregonstate.edu/courses/2017561/pages/exploration-web-application-technology-2?module_item_id=25645131
Source URL (CUD): https://canvas.oregonstate.edu/courses/2017561/pages/exploration-implementing-cud-operations-in-your-app?module_item_id=25645149

AI tools were used: 
date: 12/01/2025
prompts - "how to make the update form inline in this hbs document so that once an "EDIT" button is hit, an update form for that line will show up right below it?"
Source URL: https://copilot.microsoft.com/
!-->

<h1>Books</h1>
<h2>View, Delete, and Update Available Books</h2>

{{! READ table }}
<table>
    <thead>
        {{! For the table header row, we print the DB attribute names }}
        <tr>
            <th>Book ID</th>
            <th>Genre</th>
            <th>Title</th>
            <th>Author</th>
            <th>ISBN</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Total Sold</th>
            <th>Description</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {{! For each row, print the bookID, genreID, title, author, isbn, quantity, price, totalSold, and description }}
        {{#each books}}
        <tr>
            <td>{{this.bookID}}</td>
            <td>{{this.genre}}</td>
            <td>{{this.title}}</td>
            <td>{{this.author}}</td>
            <td>{{this.isbn}}</td>
            <td>{{this.quantity}}</td>
            <td>{{this.price}}</td>
            <td>{{this.totalSold}}</td>
            <td>{{this.description}}</td>

            {{! DELETE form }}
            <td>
              <form action="/books/delete" method="POST" style="display:inline;">
                <input type="hidden" name="delete_books_bookID" value="{{this.bookID}}" />
                <button class="deleteButton" type="submit">Delete</button>
              </form>

            {{! UPDATE - EDIT button }}
            <button class="editButton" type="button" onclick="toggleUpdateForm('{{this.bookID}}')">Edit</button>
            </td>
        </tr>

        {{! Hidden UPDATE form row }}
        <tr id="updateFormRow-{{this.bookID}}" style="display:none;">
            <td colspan="11">
                <form action="/books/update" method="POST">
                    <input type="hidden" name="update_books_bookID" value="{{this.bookID}}" required>

                    <label>Genre: </label>
                    <select name="update_books_genreID" required>
                        {{#each ../genres}}
                        <option value="{{this.genreID}}">
                            {{this.genre}} - {{this.genreID}}
                        </option>
                        {{/each}}
                    </select><br>

                    <label for='update_books_title'>Title: </label>
                    <input type="text" name="update_books_title" maxlength="200" value="{{this.title}}" required/><br>

                    <label for='update_books_author'>Author: </label>
                    <input type="text" name="update_books_author" maxlength="100" value="{{this.author}}" required/><br>

                    <label for='update_books_title'>ISBN: </label>
                    <input type="text" name="update_books_isbn" maxlength="13" value="{{this.isbn}}" required/><br>

                    <label for='update_books_quantity'>Quantity: </label>
                    <input type="number" name="update_books_quantity" min="0" value="{{this.quantity}}" required/><br>

                    <label for='update_books_price'>Price: </label>
                    <input type="number" step = "0.01" name="update_books_price" maxlength="6" min="0" value="{{this.price}}" required/><br>

                    <label for='update_books_totalSold'>Total Sold: </label>
                    <input type="number" name="update_books_totalSold" min="0" value="{{this.totalSold}}" required/><br>

                    <label for='update_books_description'>Description: </label>
                    <input type="text" name="update_books_description" maxlength="5000" value="{{this.description}}" required/><br>
                    <br>
                    
                    <input class="submitButton" type="submit" value="Save Update" />
                </form>
            </td>
        </tr>
        {{/each}}
    </tbody>
</table>

{{! CREATE form}}
<h2>Create a Book</h2>
<form class="cuForm" id="create_books_form" method="POST" action="/books/create">
  
  <label>Genre: </label>
  <select name="create_books_genreID" required>
      {{#each genres}}
      <option value="{{this.genreID}}">
          {{this.genre}} - {{this.genreID}}
      </option>
      {{/each}}
  </select><br>

  <label for='create_books_title'>Title: </label>
  <input type="text" name="create_books_title" maxlength="200" value="{{this.title}}" required/><br>

  <label for='create_books_author'>Author: </label>
  <input type="text" name="create_books_author" maxlength="100" value="{{this.author}}" required/><br>

  <label for='create_books_title'>ISBN: </label>
  <input type="text" name="create_books_isbn" maxlength="13" value="{{this.isbn}}" required/><br>

  <label for='create_books_quantity'>Quantity: </label>
  <input type="number" name="create_books_quantity" min="0" value="{{this.quantity}}" required/><br>

  <label for='create_books_price'>Price: </label>
  <input type="number" step = "0.01" name="create_books_price" maxlength="6" min="0" value="{{this.price}}" required/><br>

  <label for='create_books_totalSold'>Total Sold: </label>
  <input type="number" name="create_books_totalSold" min="0" value="{{this.totalSold}}" required/><br>

  <label for='create_books_description'>Description: </label>
  <input type="text" name="create_books_description" maxlength="5000" value="{{this.description}}" required/><br>

  <input class="submitButton" type="submit" value="Submit" />
  <br>
</form>

{{! JavaScript toggle function, Source: Copilot }}
<script>
function toggleUpdateForm(id) {
  // Hide all update forms
  document.querySelectorAll("[id^='updateFormRow-']").forEach(row => {
    row.style.display = "none";
  });

  // Show the selected form
  const row = document.getElementById("updateFormRow-" + id);
  if (row) {
    row.style.display = "table-row";
  }
}
</script>
