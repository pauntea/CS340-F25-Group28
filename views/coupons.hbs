<!--
Citation for CS 340 Project - Group 28
Date: 11/06/2025 (Web Application), 12/06/2025 (CUD)
Adapted from and based on CS 340 - Explorations - Web Application Technology and Implementing CUD operations in your app
Source URL (Web Application): https://canvas.oregonstate.edu/courses/2017561/pages/exploration-web-application-technology-2?module_item_id=25645131
Source URL (CUD): https://canvas.oregonstate.edu/courses/2017561/pages/exploration-implementing-cud-operations-in-your-app?module_item_id=25645149

AI tools were used: 
date: 12/01/2025
prompts - "how to make the update form inline in this hbs document so that once an "EDIT" button is hit, an update form for that line will show up right below it?"
Source URL: https://copilot.microsoft.com/
!-->

<h1>Coupons</h1>
<h2>View Existing Coupons</h2>

{{! READ table }}
<table>
    <thead>
        {{! For the table header row, we print the DB attribute names }}
        <tr>
            <th>Coupon ID</th>
            <th>Coupon Code</th>
            <th>Discount Type</th>
            <th>Discount</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        {{! For each row, print the couponID, couponCode, discountType, discount }}
        {{#each coupons}}
        <tr>
            <td>{{this.couponID}}</td>
            <td>{{this.couponCode}}</td>
            <td>{{this.discountType}}</td>
            <td>{{this.discount}}</td>

           {{! DELETE form }}
            <td>
              <form action="/coupons/delete" method="POST" style="display:inline;">
                <input type="hidden" name="delete_coupons_couponID" value="{{this.couponID}}" />
                <button type="submit">Delete</button>
              </form>

            {{! UPDATE - EDIT button }}
            <button type="button" onclick="toggleUpdateForm('{{this.couponID}}')">Edit</button>
            </td>
        </tr>

        {{! Hidden UPDATE form row }}
        <tr id="updateFormRow-{{this.couponID}}" style="display:none;">
            <td colspan="11">
                <form action="/coupons/update" method="POST">
                    <input type="hidden" name="update_coupons_couponID" value="{{this.couponID}}" required>

                    <label for='update_coupons_couponCode'>Coupon Code: </label>
                    <input type="text" name="update_coupons_couponCode" maxlength="50" value="{{this.couponCode}}" required/><br>

                    <label>Discount Type: </label>
                    <select name="update_coupons_discountType" required>
                        <option value="value">
                            value
                        </option>
                        <option value="percentage">
                            percentage
                        </option>
                    </select><br>

                    <label for='update_coupons_discount'>Discount: </label>
                    <input type="number" name="update_coupons_discount" min="0" value="{{this.discount}}" required/><br>
                    
                    <input type="submit" value="Save Update" />
                </form>
            </td>
        </tr>
        {{/each}}
    </tbody>
</table>

{{! CREATE form}}
<h2>Create a Coupon</h2>
<form class="cuForm" id="create_coupons_form" method="POST" action="/coupons/create">
  
  <label for='create_coupons_couponCode'>Coupon Code: </label>
  <input type="text" name="create_coupons_couponCode" maxlength="50" value="{{this.couponCode}}" required/><br>

  <label>Discount Type: </label>
  <select name="create_coupons_discountType" required>
      <option value="value">
          value
      </option>
      <option value="percentage">
          percentage
      </option>
  </select><br>

  <label for='create_coupons_discount'>Discount: </label>
  <input type="number" name="create_coupons_discount" min="0" value="{{this.discount}}" required/><br>

  <input type="submit" value="Submit" />
  <br>
</form>

{{! JavaScript toggle function, Source: Copilot }}
<script>
function toggleUpdateForm(id) {
  // Hide all update forms
  document.querySelectorAll("[id^='updateFormRow-']").forEach(row => {
    row.style.display = "none";
  });

  // Show the selected form
  const row = document.getElementById("updateFormRow-" + id);
  if (row) {
    row.style.display = "table-row";
  }
}
</script>
